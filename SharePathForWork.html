<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">-->

    <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.1.3/cyborg/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4DAPMwiyOJv/C/LvTiUsW5ueiD7EsaAhwUKO0Llp+fWzT40XrmAbayhVP00bAJVa" crossorigin="anonymous">

    <!-- pk.eyJ1IjoidWxsbWFubiIsImEiOiJjam80aXl2ejMwMDQ2M3ZtYmphZ3Yya2F0In0.Zt2Wm4lsbwdL_KhDzEWKuQ -->

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
        crossorigin="" />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
        crossorigin=""></script>

    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">


    <style type="text/css">
        #mapid {
            height: 180px;
        }
    </style>

    <title>Partager Mon Trajet</title>

    <script>

        // Données

        var monNom ="Soudant";
        var monPrenom ="Raphael";
        var monTel ="06.06.06.06.06"

        var monPote1Nom ="Ullmann";
        var monPote1Prenom ="Yanis";
        var monPote1Tel ="06.06.06.06.07"

        var monPote2Nom ="Claverie";
        var monPote2Prenom ="Elouan";
        var monPote2Tel ="06.06.06.06.08"
     
        var monPote3Nom ="Perroni";
        var monPote3Prenom ="Camille";
        var monPote3Tel ="06.06.06.06.09"

        var monPote4Nom ="AlainGuillaume";
        var monPote4Prenom ="Thomas";
        var monPote4Tel ="06.06.06.06.10"

        var monPote5Nom ="Dupin";
        var monPote5Prenom ="Martin";
        var monPote5Tel ="06.06.06.06.11"

        // Domicile
        var infoposDomicileNom ="Domicile"
        var infoposDomicileLat = "47.301906";
        var infoposDomicileLon = "-1.555031";


        // Travail
        var infoposTravailNom ="Travail"
        var infoposTravailLat = "47.224553";
        var infoposTravailLon = "-1.574735";

        // Position courrante
        var infoposCourranteNom ="I am here !"
        var infoposCourranteLat = "47.301906";
        var infoposCourranteLon = "1.555031";

         // Position ralliement
        var infoposRalliementInfo ="Join here !"
        var infoposRalliementLat = "";
        var infoposRalliementLon = "";       

        // id Map
        var id ="";

        function afficherPosCallback(position) {
            var infopos = "Position déterminée :\n";
            var infoposCourranteLat = position.coords.latitude;
            var infoposCourranteLon = position.coords.longitude;

         
         //   infopos += "Latitude : " + position.coords.latitude + "\n";
         //   infopos += " / Longitude: " + position.coords.longitude + "\n";
         //   document.getElementById("infoposition").innerHTML = infopos;

        };

        function errorCallback(error) {
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    alert("L'utilisateur n'a pas autorisé l'accès à sa position");
                    break;
                case error.POSITION_UNAVAILABLE:
                    alert("L'emplacement de l'utilisateur n'a pas pu être déterminé");
                    break;
                case error.TIMEOUT:
                    alert("Le service n'a pas répondu à temps");
                    break;
            }
        };

        function activerGeolocalisation(){
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(afficherPosCallback, errorCallback, {
                            enableHighAccuracy: true,
                            timeout: 5000,
                            maximumAge: 60000
                        });
            } else {
                        alert("Votre navigateur ne prend pas en compte la géolocalisation HTML5");
                    }
        }

        function afficherPosition() {
                        navigator.geolocation.getCurrentPosition(afficherPosCallback, errorCallback, {
                            enableHighAccuracy: true,
                            timeout: 5000,
                            maximumAge: 60000
                        });
        }

        function joindrePosition(nomUtilisateur) {
                        navigator.geolocation.getCurrentPosition(joindrePosCallback, errorCallback, {
                            enableHighAccuracy: true,
                            timeout: 5000,
                            maximumAge: 60000
                        });
                        if (infoposRalliementLat,infoposRalliementLon) {
                            afficherMarker(infoposRalliementLat,infoposRalliementLon,nomUtilisateur);
                        }
                      
        }

        function joindrePosCallback(position) {
            infoposRalliementLat = position.coords.latitude;
            infoposRalliementLon = position.coords.longitude;
        };

        function watchPosition(){
            id = navigator.geolocation.watchPosition(afficherPosCallback, errorCallback, {
                            enableHighAccuracy: true,
                            timeout: 5000,
                            maximumAge: 60000
                        });
            
        }

        function clearRoute(){

            navigator.geolocation.clearWatch(id);
                       
        }

        function afficherMarker(lat, lon, Nom) {
            L.marker([lat, lon]).addTo(mymap)
            .bindPopup(Nom)
            .openPopup();
            mymap.setView([lat, lon], 13);
        }

</script>

</head>

<body>

    <h1>Partager Mon Trajet</h1>
    <script>
         activerGeolocalisation();
    </script>

    <div class="row show-grid">
        <div class="col-2">
            <img src="img/avatar01.jpg" alt="" />
        </div>
        <div class="col-4">
                <div ip="Nom"> Nom : <script> document.write(monNom) </script> </div> 
                <div ip="Prenom"> Prénom : <script> document.write(monPrenom) </script>  </div> 
                <div ip="Tel"> Tél : <script> document.write(monTel) </script> </div> 
        </div>
        <div class="col-3">
                <div ip="maPosLat">lat : <script> document.write(infoposCourranteLat) </script> </div> 
                <div ip="maPostLon">lon : <script> document.write(infoposCourranteLon) </script>  </div> 
 
        </div>
        <div class="col-3">
                <button type="button" class="btn btn-primary" onclick="javascript:watchPosition()">Activation</button>
                <button type="button" class="btn btn-primary" onclick="javascript:clearRoute()">Clear</button>
         </div>
    </div>

    <div class="row show-grid">
        <div class="col-2 col-sm-3">
            <img src="img/avatar01.jpg" alt="Nom 1" />
        </div>
        <div class="col-4">
                <div ip="Nom"> Nom : <script> document.write(monPote1Nom) </script> </div> 
                <div ip="Prenom"> Prénom : <script> document.write(monPote1Prenom) </script>  </div> 
                <div ip="Tel"> Tél : <script> document.write(monPote1Tel) </script> </div> 
        </div>
        <div class="col-6 col-sm-3">
                <button type="button" class="btn btn-primary" onclick="javascript:joindrePosition(monPote1Nom)">Rallier</button>
        </div>
    </div>
    <div class="row show-grid">
            <div class="col-4 col-sm-3">
                <img src="img/avatar02.jpg" alt="Nom 2" />
             </div>

             <div class="col-4">
                    <div ip="Nom"> Nom : <script> document.write(monPote2Nom) </script> </div> 
                    <div ip="Prenom"> Prénom : <script> document.write(monPote2Prenom) </script>  </div> 
                    <div ip="Tel"> Tél : <script> document.write(monPote2Tel) </script> </div> 
            </div>
            <div class="col-4 col-sm-3">
                    <button type="button" class="btn btn-primary" onclick="javascript:joindrePosition(monPote2Nom)">Rallier</button>
                </div>
         
        </div>

        <div class="row show-grid">
                <div class="col-4 col-sm-3">
                    <img src="img/avatar01.jpg" alt="Nom 3" />
                </div>
                <div class="col-4">
                        <div ip="Nom"> Nom : <script> document.write(monPote3Nom) </script> </div> 
                        <div ip="Prenom"> Prénom : <script> document.write(monPote3Prenom) </script>  </div> 
                        <div ip="Tel"> Tél : <script> document.write(monPote3Tel) </script> </div> 
                </div>
                <div class="col-4 col-sm-3">
                        <button type="button" class="btn btn-primary" onclick="javascript:joindrePosition(monPote3Nom)">Rallier</button>
                    </div>
      
            </div>

            <div class="row show-grid">
 
                    <div class="col-4 col-sm-3">
                        <img src="img/avatar02.jpg" alt="Nom 4" />
                    </div>
                    <div class="col-4">
                            <div ip="Nom"> Nom : <script> document.write(monPote4Nom) </script> </div> 
                            <div ip="Prenom"> Prénom : <script> document.write(monPote4Prenom) </script>  </div> 
                            <div ip="Tel"> Tél : <script> document.write(monPote4Tel) </script> </div> 
                    </div>
                    <div class="col-4 col-sm-3">
                            <button type="button" class="btn btn-primary" onclick="javascript:joindrePosition(monPote4Nom)">Rallier</button>
                    </div>
            
                </div>

    <div class="row show-grid">
        <div class="col-12 col-sm-8"> MAP
            <div id="mapid" style="width: 600px; height: 400px;"></div>
            <script>

                 if (infoposDomicileLat, infoposDomicileLon) {
                    var mymap = L.map('mapid').setView([infoposDomicileLat, infoposDomicileLon], 13)
                 }
                 afficherMarker(infoposDomicileLat,infoposDomicileLon,infoposDomicileNom);
                 afficherMarker(infoposTravailLat,infoposTravailLon,infoposTravailNom);
                // mymap.locate({setView: true, maxZoom: 16});

                L.tileLayer(
                    'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidWxsbWFubiIsImEiOiJjam80aXl2ejMwMDQ2M3ZtYmphZ3Yya2F0In0.Zt2Wm4lsbwdL_KhDzEWKuQ', {
                        maxZoom: 18,
                        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
                            '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                            'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                        id: 'mapbox.streets'
                    }).addTo(mymap);

            </script>
        </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

</body>

</html>